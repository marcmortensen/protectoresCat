# @protectorescat/web

Nuxt.js web application that displays animal shelters and rescue organizations across Catalonia. This application consumes organization data generated by the `@protectorescat/shelters` package.

## Overview

This is a Nuxt 4 application built with:

- **Nuxt.js** - The Vue.js framework
- **Vue** - The progressive JavaScript framework
- **TypeScript** - Type-safe JavaScript
- **Nuxt Content** - Content management
- **Nuxt UI** - UI component library
- **Tailwind CSS** - Utility-first CSS framework

## Prerequisites

- Node.js 22.x or higher
- pnpm 10.19.0 or higher

## Getting Started

### Installation

Install dependencies from the root of the monorepo:

```bash
# From the root directory
pnpm install
```

Or from this directory:

```bash
cd apps/web
pnpm install
```

### Development Server

Start the development server:

```bash
pnpm dev
```

The application will be available at `http://localhost:3000`.

### Type Checking

Run TypeScript type checking without building:

```bash
pnpm tsc
```

## Project Structure

```
web/
├── app/
│   ├── pages/                  # Nuxt pages (file-based routing)
│   └── ...
├── content/
│   ├── organizations/          # Organization JSON files (generated by shelters package)
│   └── organizationsByRegion/  # Region-grouped organization files
├── public/
│   ├── organizationLogos/      # Organization logo files (WebP format)
│   └── ...
├── server/                     # Server-side code
├── nuxt.config.ts              # Nuxt configuration
├── content.config.ts           # Content module configuration
└── package.json                # Dependencies and scripts
```

## Data Flow

The web application consumes data generated by the `@protectorescat/shelters` package:

1. Organizations are defined in `packages/shelters/src/organization.ts`
2. The shelters package generates JSON files
3. JSON files are copied to `apps/web/content/organizations/` and `apps/web/content/organizationsByRegion/`
4. Logo files are copied to `apps/web/public/organizationLogos/`
5. The Nuxt Content module reads and serves this data

### Updating Organization Data

After adding or modifying organizations in the shelters package:

1. Navigate to the shelters package:

   ```bash
   cd packages/shelters
   ```

2. Build and process organizations:

   ```bash
   pnpm build
   pnpm test:unit-run
   pnpm start
   ```

3. Return to the web app directory:

   ```bash
   cd ../../apps/web
   ```

4. Restart the development server if it's running:
   ```bash
   pnpm dev
   ```

The new organization data will be available in the web application.

## Available Scripts

| Script               | Description                  |
| -------------------- | ---------------------------- |
| `pnpm dev`           | Start development server     |
| `pnpm build`         | Build for production         |
| `pnpm build-netlify` | Build for Netlify deployment |
| `pnpm preview`       | Preview production build     |
| `pnpm generate`      | Generate static site         |
| `pnpm tsc`           | Type check without building  |

## Development

### Working with Content

Organization data is managed through Nuxt Content. Access it in your components:

```vue
<script setup>
const { data: organizations } = await useAsyncData("organizations", () =>
  queryContent("/organizations").find()
);
</script>
```

### Styling

This project uses Tailwind CSS for styling.

## Configuration

### Nuxt Configuration

Edit `nuxt.config.ts` to configure:

- Modules
- Build settings
- Runtime config
- SEO settings

### Content Configuration

Edit `content.config.ts` to configure:

- Content collections
- Schema validation
- Data sources

## Troubleshooting

### Organization Data Not Appearing

1. Ensure the shelters package has generated the JSON files:

   ```bash
   cd packages/shelters
   pnpm start
   ```

2. Check that files exist in:
   - `apps/web/content/organizations/`
   - `apps/web/content/organizationsByRegion/`

3. Restart the development server

### Build Errors

- Check TypeScript errors: `pnpm tsc`
- Verify all dependencies are installed: `pnpm install`
- Clear `.nuxt` and `.output` directories and rebuild

### Port Already in Use

If port 3000 is in use, Nuxt will automatically try the next available port. Check the console output for the actual URL.

## License

See the [LICENSE](./LICENSE) file.
